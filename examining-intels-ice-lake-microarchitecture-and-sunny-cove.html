<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>DL Boost and New Instructions: Intels AI Acceleration Attack - JadeDash</title><script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content="If you like buzzwords, then the field of artificial intelligence is full of them. Unless you are deeply embedded in the use or development of the technologies in this field, it can be pretty easy to be overwhelmed by all the acronyms and how they relate to each other. This complication is multiplied out by"><meta name=robots content="index,follow,noarchive"><meta property="og:title" content="DL Boost and New Instructions: Intels AI Acceleration Attack"><meta property="og:description" content="If you like buzzwords, then the field of artificial intelligence is full of them. Unless you are deeply embedded in the use or development of the technologies in this field, it can be pretty easy to be overwhelmed by all the acronyms and how they relate to each other. This complication is multiplied out by"><meta property="og:type" content="article"><meta property="og:url" content="/examining-intels-ice-lake-microarchitecture-and-sunny-cove.html"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-08-13T00:00:00+00:00"><meta property="article:modified_time" content="2024-08-13T00:00:00+00:00"><meta itemprop=name content="DL Boost and New Instructions: Intels AI Acceleration Attack"><meta itemprop=description content="If you like buzzwords, then the field of artificial intelligence is full of them. Unless you are deeply embedded in the use or development of the technologies in this field, it can be pretty easy to be overwhelmed by all the acronyms and how they relate to each other. This complication is multiplied out by"><meta itemprop=datePublished content="2024-08-13T00:00:00+00:00"><meta itemprop=dateModified content="2024-08-13T00:00:00+00:00"><meta itemprop=wordCount content="1900"><meta itemprop=keywords content><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=https://assets.cdnweb.info/hugo/mainroad/css/style.css><link rel="shortcut icon" href=./favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=./index.html title=JadeDash rel=home><div class="logo__item logo__text"><div class=logo__title>JadeDash</div></div></a></div><div class=divider></div></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>DL Boost and New Instructions: Intels AI Acceleration Attack</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2024-08-13T00:00:00Z>August 13, 2024</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=./categories/blog/ rel=category>blog</a></span></div></div></header><div class="content post__content clearfix"><p>If you like buzzwords, then the field of artificial intelligence is full of them. Unless you are deeply embedded in the use or development of the technologies in this field, it can be pretty easy to be overwhelmed by all the acronyms and how they relate to each other. This complication is multiplied out by the new technologies that hardware manufacturers develop in order to support the methods the expert’s use, especially as those methods transition from software implementations to hardware accelerated methods.</p><p>Intel’s side of the equation on this is two-fold. On one level, the company wants to accelerate how these algorithms are trained – Intel wants to be able to provide the raw horsepower and bandwidth to push millions of results to train these algorithms in order to improve accuracy and efficiency. Training on this scale typically happens at the datacenter, and Intel will happily promote its FPGAs or Neural Network Processors to help do this.</p><p>The other side of the discussion is inference – the art of taking those trained algorithms and showing them new data to make accurate predictions. The simple example of inference is showing an algorithm that has been trained to identify different objects a new image that it has never seen before. Inference, in contrast to training, happens at the device level, is less computationally strenuous, but can be optimized to a super low power hardware accelerated implementation. There can also be a tradeoff between speed/power and accuracy. Again, the most obvious example of this is a smartphone identifying that the camera is pointed at food, or a sunset, or a building, or a cat.</p><p>The two sides of artificial intelligence, training and inference, happen at very different ends of the spectrum. Training occurs at the application developer level, while inference happens very much at the user level. For products that ultimately end up in the hands of end-users, being able to accelerate inference is a key to user experience.</p><p>However, Intel has a problem here. In fact, all companies that sell mobile PC products to end-users have a problem. The concepts of interference, such as identifying an item on a camera view screen, are easy to understand in a smartphone form factor. But apply that logic to a laptop, a notebook, or a desktop, and the applicability of how AI can improve the user experience starts to get a little distorted. It is not immediately obvious in what ways that AI can improve what a user does on these devices. The smartphone, by contrast, is an easier sell.</p><p>As a result, Intel has needed to go out into the community. Its new chip, Ice Lake, is a sledgehammer, and it’s looking for a nail, no matter how small. The truth of it is that a lot of end-user software does not have artificial intelligence built into it – any ‘intelligence’ that most software has is typically a bunch of ‘if this then that’ statements which do not fall in this category.</p><p>This ‘hammer looking for a nail’ implementation was very apparent at Computex 2019. Intel showcased a few demos with its new technology, however most of them were fairly niche. Two examples of this include:</p><ul><li>Photo Album sorting: searching for all ‘beach’ photos in a photo album that hasn’t been manually tagged.</li><li>Converting a single 2D image into a 3D model for use in 3D visualization environments</li></ul><p>The first case might be interesting to the wider public – and indeed Apple already does something like this on macOS – however the second use case is currently aimed at business or archival use, which is a specific niche. Ultimately Intel is looking to increase the amount of available tools, even if they are niche, which can be accelerated on Ice Lake. Intel is taking all suggestions on this.</p><p>How Intel is accelerating these inference models is through its ‘DL Boost’ technology, which is essentially a form of vector acceleration.</p><h3>DL Boost and AVX-512</h3><p>One of the features of the Ice Lake cores is that silicon is dedicated to AVX-512 operation. This allows for 512-bit instructions and math to be executed at once. With Ice Lake, it marks the first consumer platform from Intel to support the feature, if you exclude Cannon Lake which was not widely available. To date only Intel’s Xeon Skylake or newer silicon, or Xeon Phi, has had AVX-512 as part of the design. As we saw in our review of Cannon Lake, when AVX-512 code is run on these systems, <a href=#>it can be very effective</a>: a dual core system with AVX-512 outscored a 16-core system running AVX2 (AVX-256).</p><p>AVX-512 forms the basis for Intel’s DL Boost libraries, which form part of several SDKs in Intel’s software strategy, such as <a href=#>the OpenVINO toolkit</a>. DL Boost takes advantage of the new core’s abilities to reform neural network calculations in the form of lower precision calculations, from FP32 to FP16 to INT8 and even down to INT2. The balance here is between accuracy, power, and computational complexity: for example, in most non-critical situations, dropping the accuracy of an inference calculation from 94% to 93% accuracy would be worth it if it reduced latency and power consumption by half. DL Boost accelerated libraries also allow for mathematical numerical transforms in neural network calculations to further increase throughput and decrease power.</p><p align=center><a href=#><img alt src=https://cdn.statically.io/img/images.anandtech.com/doci/14514/Intel%20Computex%20Kickoff%20May%2026%202019-page-037_575px.jpg style=margin:auto;display:block;text-align:center;max-width:100%;height:auto></a></p><p>Ultimately DL Boost covers the gamut from training to inference – Intel promotes its use on the server Xeon product line for training, whereas the Ice Lake consumer line of products will be focused on inference. Again, its usefulness when it comes to consumer products will initially be limited, given the lack of common AI inference workloads on modern systems. Intel promotes the AIXPRT synthetic benchmark suite as an example of performance uplift, however that focuses almost entirely on image recognition.</p><h3><strong>New Instructions</strong></h3><p>Alongside DL Boost, Intel has implemented a series of AVX-512 instructions for other use cases.</p><p>AVX-512_VBMI is one layer of Vector Byte Manipulation Instructions, which includes permutes and shifts:</p><ul><li>VPERMB: 64-byte any-to-any shuffle, 3 clocks, 1 per clock</li><li>VPERMI2B: 128-byte any-to-any overwriting indexes, 5 clocks, 1 per 2 clocks</li><li>VPERMT2B: 128-byte any-to-any overwriting tables, 5 clocks, 1 per 2 clocks</li><li>VPMULTISHIFTQB: Base64 conversion, 3 clocks, 1 per clock</li></ul><p>AVX-512_VBMI2 takes this a stage further, enabling expand and compress functionality</p><ul><li>VPCOMPRESSB: Store sparse packed byte integer values into dense memory/register</li><li>VPCOMPRESSW: Store sparse packed word integer values into dense memory/register</li><li>VPEXPANDB: Load sparse packed byte integer values from dense memory/register</li><li>VPEXPANDW: Load sparse packed word integer values from dense memory/register</li><li>VPSHLD: Concatenate and shift packed data left logical</li><li>VPSHRD: Concatenate and shift packed data right logical</li><li>VPSHLDV: Concatenate and variable shift packed data left logical</li><li>VPSHRDV: Concatenate and variable shift packed data right logical</li></ul><p>AVX-512_BITALG enables a number of highly sort-after bit algorithms:</p><ul><li>VPOPCNTB: Return the number of bits set to 1 in a byte</li><li>VPOPCNTW: Return the number of bits set to 1 in a word</li><li>VPSHUFBITQMB&nbsp;: Shuffles bits from quadword elements using byte indexes into mask</li></ul><p>AVX-512_IFMA are 52-bit Integer fused multiply add (FMA) instructions that behave identically to AVX-512 floating point FMA, but offering a latency of four clocks and a throughput of two per clock (for xmm/ymm, zmm is four and one). This instruction is commonly listed as helping cryptographic functionality, but also means there is now added support for arbitrary precision arithmetic.</p><ul><li>VPMADD52LUQ: Packed multiply of unsigned 52-bit integers and add the low 52-bit products to qword accumulators</li><li>VPMADD52HUQ: Packed multiply of unsigned 52-bit integers and add the high 52-bit products to 64-bit accumulators</li></ul><p>Alexander Yee, the developer of the hyper-optimized mathematical constant calculator <a href=#>y-cruncher</a>, explained to be why IFMA helps his code when calculating constants like Pi:</p><p>The standard double-precision floating-point hardware in Intel CPUs has a very powerful multiplier that has been there since antiquity. But it couldn't be effectively tapped into because that multiplier was buried inside the floating-point unit. The SIMD integer multiply instructions only let you utilize up to 32x32 out of the 52x52 size of the double-precision multiply hardware with additional overhead needed. This inefficiency didn't go unnoticed, so people ranted about it, hence why we now have IFMA.</p><p>The main focus of research papers on this is that big number arithmetic that wants the largest integer multiplier possible. On x64 the largest multiplier was the 64 x 64 -> 128-bit scalar multiply instruction. This gives you (64*64 = 4096 bits) of work per cycle. With AVX512, the best you can do is eight 32 x 32 -> 64-bit multiply via the VPMULDQ instruction, which gets you (8 SIMD lanes * 32*32 * 2FMA = 16384 bits) of work per cycle. But in practice, it ends up being about half of that because you have the overhead of additions, shifts, and shuffles competing for the same execution ports.</p><p>With AVX512-IFMA, users can unleash the full power of the double-precision hardware. A low/high IFMA pair will get you (8 SIMD lanes * 52*52 = 21632 bits) of work. That's 21632/cycle with 2 FMAs or 10816/cycle with 1 FMA. But the fused addition and 12 "spare bits" allows the user to eliminate nearly all the overhead that is needed for the AVX512-only approach. Thus it is possible to achieve nearly the full 21632/cycle of efficiency with the right port configuration (CNL/ICL only has 1 FMA).</p><p>There's more to the IFMA arbitrary precision arithmetic than just the largest multiplier possible. RSA encryption is probably one of the only applications that will get the full benefit of the IFMA as described above. y-cruncher benefits partially. Prime95 will not benefit at all.</p><p>For the algorithms that can take advantage of it, this boils down to the following table:</p><table border=0 width=85%><tbody></tbody><tbody><tr class=tgrey><td colspan=4>IFMA Performance</td></tr><tr class=tlblue><td>&nbsp;</td><td>Scalar x64</td><td>AVX512-F</td><td>AVX512-IFMA</td></tr><tr><td class=tlgrey>Single 512b FMA</td><td>4096-bit/cycle</td><td>~4000-bit/cycle</td><td>10816-bit/cycle</td></tr><tr><td class=tlgrey>Dual 512b FMA</td><td>4096-bit/cycle</td><td>~8000-bit/cycle</td><td>21632-bit/cycle</td></tr></tbody></table><p>AVX-512_VAES are vector extension instructions for AES commands. Current cores can enable 128-bit per-cycle, whereas using VAES instructions can enable 4x128-bit per cycle.</p><ul><li>VAESDEC: Perform one round of an AES decryption flow</li><li>VAESENC: Perform one round of an AES encryption flow</li><li>VAESDECLAST: Perform last round of an AES decryption flow</li><li>VAESENCLAST: Perform last round of an AES encryption flow</li></ul><p>AVX-512_VPCLMULQDQ is a single instruction also added to Ice Lake that enables carryless multiplication of a long quadword values.</p><ul><li>VPCLMULQDQ: Carry-less multiplication quadword</li></ul><p>AVX-512+GFNI are ‘Galois Field’ instructions.</p><ul><li>GF2P8AFFINEINVQB: Galois field affine transformation inverse</li><li>GF2P8AFFINEQB: Galois field affine transformation</li><li>GF2P8MULB: Galois field multiply bytes</li></ul><p>Beyond the AVX-512 instructions, there are a number of new instructions the core, particularly pertaining to cryptography. Ice Lake-U will support the SHA instructions, used for accelerating SHA-1 and SHA-256 algorithms:</p><ul><li>SHA1RNDS4</li><li>SHA1NEXTE</li><li>SHA1MSG1</li><li>SHA1MSG2</li><li>SHA256RNDS2</li><li>SHA256MSG1</li><li>SHA256MSG2</li></ul><p>The new Ice Lake core also has a Gaussian Neural Accelerator (GNA), which is a hardware block that enables low-power wake on voice. Intel also has the Gaussian Mixture Model (GMM) inside the core, as it has since Skylake, however Intel still has not provided much (if any) information on how it works. If you’re lucky, you might find it referenced in a CPU manual that it exists, but beyond this, little information is present. It stands to reason that the GNA will get the same treatment. Our best guess is that these units assist Microsoft Cortana for low-powered wake-on voice inference algorithms; however they don’t seem to be as open to other software developers, or perhaps it is but only under an NDA with Intel.</p><p class=postsid style=color:rgba(255,0,0,0)>ncG1vNJzZmivp6x7orrAp5utnZOde6S7zGiqoaenZH51gZBtZp6wkaK2r7XNoGSipqSaubR5yJycZqSRoLJuucicqaiZopi1qsDEnKuuqpVirq%2BwjKysp6apYrCwwsRobA%3D%3D</p></div></article></main><nav class="pager flex"><div class="pager__item pager__item--prev"><a class=pager__link href=./252882-joan-collins-celebrates-19-years-marriag-html.html rel=prev><span class=pager__subtitle>«&#8201;Previous</span><p class=pager__title>Joan Collins Celebrates 19 Years of Marriage with a Beautiful Throwback Photo from Her Wedding</p></a></div><div class="pager__item pager__item--next"><a class=pager__link href=./carmen-amina-net-worth-328288.html rel=next><span class=pager__subtitle>Next&#8201;»</span><p class=pager__title>Carmen Amina Net Worth</p></a></div></nav></div><aside class=sidebar><div class="widget-recent widget"><h4 class=widget__title>Recent Posts</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=./daphne-oz-net-worth-67264.html>Daphne Oz Net Worth</a></li><li class=widget__item><a class=widget__link href=./energy-balls.html>Energy Balls</a></li><li class=widget__item><a class=widget__link href=./holly-rowe-net-worth-2024.html>Holly Rowe Net Worth 2024</a></li><li class=widget__item><a class=widget__link href=./how-to-get-into-the-chamber-of-secrets-in-hogwarts-legacy.html>How to get into the Chamber of Secrets in Hogwarts Legacy</a></li><li class=widget__item><a class=widget__link href=./143165-loretta-lynn-sings-a-birthday-concert-he-html.html>Loretta Lynn Sings at a Birthday Concert in Her First Public Performance since Suffering a Stroke</a></li></ul></div></div><div class="widget-categories widget"><h4 class=widget__title>Categories</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=./categories/blog/>blog</a></li></ul></div></div></aside></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2024 JadeDash.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=https://assets.cdnweb.info/hugo/mainroad/js/menu.js></script>
<script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://iklan.listspress.com/floating.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://iklan.listspress.com/tracking_server_6.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//analytics.cdnweb.info/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script></body></html>